<!DOCTYPE html>
<html>

<head>
    <title>Student Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100">
    <nav class="bg-blue-600 text-white p-4">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-bold">Student Dashboard</h1>
            <div class="space-x-4">
                <span>Welcome, {{ user.full_name }}</span>
                <a href="/profile" class="hover:bg-blue-700 px-3 py-2 rounded">My Profile</a>
                <a href="/logout" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded">Logout</a>
            </div>
        </div>

    </nav>

    <div class="container mx-auto mt-8 p-4">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <div class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-xl font-semibold mb-2">Applications</h3>
                <p class="text-3xl font-bold text-blue-600">{{ applications|length }}</p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-xl font-semibold mb-2">Tasks</h3>
                <p class="text-3xl font-bold text-green-600">{{ tasks|length }}</p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-xl font-semibold mb-2">Available Internships</h3>
                <p class="text-3xl font-bold text-purple-600">{{ internships|length }}</p>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <div class="bg-white p-6 rounded-lg shadow">
                <h2 class="text-2xl font-bold mb-4">Available Internships</h2>
                {% if internships %}
                {% for internship in internships %}
                <div class="border border-gray-200 rounded-lg p-4 mb-4">
                    <h3 class="text-lg font-semibold">{{ internship.title }}</h3>
                    <p class="text-gray-600">{{ internship.company }} - {{ internship.location }}</p>
                    <p class="text-sm text-gray-500 mt-2">{{ internship.description[:100] }}...</p>
                    <button class="mt-3 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
                        Apply Now
                    </button>
                </div>
                {% endfor %}
                {% else %}
                <p class="text-gray-500">No internships available at the moment.</p>
                {% endif %}
            </div>
            <!-- Add this to your existing student dashboard -->
            <div class="row mb-4">
                <div class="col-md-4">
                    <div class="card text-white bg-primary">
                        <div class="card-body text-center">
                            <h3>{{ internships|length }}</h3>
                            <p>Available Internships</p>
                            <a href="/internships" class="btn btn-light btn-sm">Browse All</a>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card text-white bg-success">
                        <div class="card-body text-center">
                            <h3>{{ applications|length }}</h3>
                            <p>My Applications</p>
                            <a href="/my-applications" class="btn btn-light btn-sm">View All</a>
                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card text-white bg-warning">
                        <div class="card-body text-center">
                            <h3>{{ applications|selectattr('status', 'equalto', 'pending')|list|length }}</h3>
                            <p>Pending Applications</p>
                            <a href="/my-applications" class="btn btn-light btn-sm">Check Status</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="space-y-6">
                <div class="bg-white p-6 rounded-lg shadow">
                    <h2 class="text-2xl font-bold mb-4">My Applications</h2>
                    {% if applications %}
                    {% for application in applications %}
                    <div class="border border-gray-200 rounded-lg p-4 mb-3">
                        <div class="flex justify-between items-center">
                            <div>
                                <h4 class="font-semibold">{{ application.internship.title }}</h4>
                                <p class="text-sm text-gray-600">Applied: {{
                                    application.application_date.strftime('%Y-%m-%d') }}</p>
                            </div>
                            <span class="px-3 py-1 rounded-full text-sm font-semibold 
                                    {% if application.status == 'approved' %}bg-green-100 text-green-800
                                    {% elif application.status == 'rejected' %}bg-red-100 text-red-800
                                    {% else %}bg-yellow-100 text-yellow-800{% endif %}">
                                {{ application.status|title }}
                            </span>
                        </div>
                    </div>
                    {% endfor %}
                    {% else %}
                    <p class="text-gray-500">No applications yet.</p>
                    {% endif %}
                </div>

                <div class="bg-white p-6 rounded-lg shadow">
                    <h2 class="text-2xl font-bold mb-4">My Tasks</h2>
                    {% if tasks %}
                    {% for task in tasks %}
                    <div class="border border-gray-200 rounded-lg p-4 mb-3">
                        <h4 class="font-semibold">{{ task.title }}</h4>
                        <p class="text-sm text-gray-600">{{ task.description }}</p>
                        <div class="mt-2">
                            <div class="flex justify-between text-sm mb-1">
                                <span>Progress</span>
                                <span>{{ task.progress }}%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-blue-600 h-2 rounded-full" style="width: {{ task.progress }}%"></div>
                            </div>
                        </div>
                        <span class="inline-block mt-2 px-2 py-1 text-xs rounded 
                                {% if task.status == 'completed' %}bg-green-100 text-green-800
                                {% elif task.status == 'in_progress' %}bg-blue-100 text-blue-800
                                {% else %}bg-gray-100 text-gray-800{% endif %}">
                            {{ task.status|replace('_', ' ')|title }}
                        </span>
                    </div>
                    {% endfor %}
                    {% else %}
                    <p class="text-gray-500">No tasks assigned yet.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</body>

</html>